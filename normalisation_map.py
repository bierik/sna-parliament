from itertools import chain


normalisation_map = {
    179: [2121, 1373, 5808],
    354: [5907],
    366: [3604, 921],
    402: [6297, 4100, 6626, 2993, 3323],
    446: [6232, 930, 2976, 1127],
    453: [
        3114,
        4576,
        1600,
        6731,
        6347,
        5139,
        5137,
        2510,
        5664,
        2004,
        5471,
        5138,
        2003,
        1114,
        3892,
        1438,
        437,
        6318,
        4645,
        6732,
        1491,
        3403,
    ],
    460: [52, 118, 2155, 5553, 3285],
    477: [
        5933,
        2767,
        804,
        6197,
        345,
        2928,
        2717,
        3576,
        4451,
        1024,
        1157,
        6023,
        2935,
        2726,
        1927,
        146,
        3538,
        2409,
        2773,
        6351,
    ],
    517: [
        5637,
        6195,
        5639,
        6078,
        2967,
        4356,
        519,
        3520,
        6359,
        2985,
        2641,
        5256,
        3592,
        2736,
        2714,
        2733,
        2251,
        6063,
        2930,
        2728,
        6019,
        3358,
        3298,
        3107,
        3307,
        6079,
        5486,
        2918,
        3017,
        920,
        3299,
        800,
        2713,
        6301,
        5487,
        3287,
        5489,
    ],
    557: [4176],
    576: [81],
    580: [3478, 2576, 1372, 884, 1349],
    581: [5679, 5662, 4565, 3440, 4975],
    657: [
        5298,
        3624,
        4926,
        6621,
        5207,
        4932,
        4410,
        2298,
        3672,
        5342,
        5248,
        681,
        5250,
        5209,
        2478,
        5065,
        5568,
        2840,
        6136,
    ],
    658: [1493],
    857: [2906, 3568],
    877: [1590, 4116, 2811, 5558, 1955, 5651, 3341, 5803, 2953, 5096],
    1057: [1056, 1060, 940],
    1421: [1406],
    1613: [5562, 5136, 5100],
    2227: [2455],
    2351: [2838],
    2735: [5424],
    2911: [2910],
    3208: [3209],
    3212: [5277],
    3399: [3397, 5987, 3398, 3400, 3401],
    3811: [
        3803,
        4558,
        3804,
        3805,
        3806,
        3807,
        3808,
        3809,
        3810,
        3812,
        4562,
        4560,
        4559,
    ],
    3976: [97, 991, 5798, 4446],
    4514: [485, 4517, 4515],
    5076: [5077],
    5744: [5748],
    6556: [1830],
}

inverted_nomalisation_map = {}

for normalized, definitions in normalisation_map.items():
    for definition in definitions:
        inverted_nomalisation_map[definition] = normalized


def normalize_organisation(organisation_id):
    return inverted_nomalisation_map.get(organisation_id, organisation_id)


def get_organisations_to_normalize():
    return list(chain.from_iterable(normalisation_map.values()))
